package com.ssafy.countingstar.service;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;

import java.io.ByteArrayInputStream;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Unmarshaller;

import org.junit.jupiter.api.Test;

import com.ssafy.countingstar.data.raw.ASOSResponse;

class XMLParsingTest {
	
	public final static String xml = "<response>\r\n"
			+ "<header>\r\n"
			+ "<resultCode>00</resultCode>\r\n"
			+ "<resultMsg>NORMAL_SERVICE</resultMsg>\r\n"
			+ "</header>\r\n"
			+ "<body>\r\n"
			+ "<dataType>XML</dataType>\r\n"
			+ "<items>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 01:00</tm>\r\n"
			+ "<rnum>1</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>3.6</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>2.5</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>290</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>76</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>6.0</pv>\r\n"
			+ "<td>-0.2</td>\r\n"
			+ "<pa>1007.8</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1018.4</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss/>\r\n"
			+ "<ssQcflg>9</ssQcflg>\r\n"
			+ "<icsr/>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>9</dc10Tca>\r\n"
			+ "<dc10LmcsCa>8</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd/>\r\n"
			+ "<lcsCh>3</lcsCh>\r\n"
			+ "<vs>310</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo>40</dmstMtphNo>\r\n"
			+ "<ts>0.0</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>0.5</m005Te>\r\n"
			+ "<m01Te>0.0</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.7</m03Te>\r\n"
			+ "</item>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 02:00</tm>\r\n"
			+ "<rnum>2</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>2.7</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>2.0</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>290</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>77</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>5.7</pv>\r\n"
			+ "<td>-0.9</td>\r\n"
			+ "<pa>1007.5</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1018.2</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss/>\r\n"
			+ "<ssQcflg>9</ssQcflg>\r\n"
			+ "<icsr/>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>8</dc10Tca>\r\n"
			+ "<dc10LmcsCa>5</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd/>\r\n"
			+ "<lcsCh>4</lcsCh>\r\n"
			+ "<vs>268</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo>40</dmstMtphNo>\r\n"
			+ "<ts>-0.6</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>0.1</m005Te>\r\n"
			+ "<m01Te>-0.1</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.7</m03Te>\r\n"
			+ "</item>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 03:00</tm>\r\n"
			+ "<rnum>3</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>2.0</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>1.8</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>270</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>78</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>5.5</pv>\r\n"
			+ "<td>-1.4</td>\r\n"
			+ "<pa>1007.7</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1018.4</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss/>\r\n"
			+ "<ssQcflg>9</ssQcflg>\r\n"
			+ "<icsr/>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>9</dc10Tca>\r\n"
			+ "<dc10LmcsCa>9</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd>As</clfmAbbrCd>\r\n"
			+ "<lcsCh>35</lcsCh>\r\n"
			+ "<vs>246</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo>40</dmstMtphNo>\r\n"
			+ "<ts>-0.9</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>0.0</m005Te>\r\n"
			+ "<m01Te>0.0</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.7</m03Te>\r\n"
			+ "</item>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 04:00</tm>\r\n"
			+ "<rnum>4</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>1.2</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>3.6</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>290</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>68</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>4.5</pv>\r\n"
			+ "<td>-4.0</td>\r\n"
			+ "<pa>1008.2</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1019.0</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss/>\r\n"
			+ "<ssQcflg>9</ssQcflg>\r\n"
			+ "<icsr/>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>8</dc10Tca>\r\n"
			+ "<dc10LmcsCa>2</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd>ScAc</clfmAbbrCd>\r\n"
			+ "<lcsCh>11</lcsCh>\r\n"
			+ "<vs>379</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo>40</dmstMtphNo>\r\n"
			+ "<ts>-1.1</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>0.0</m005Te>\r\n"
			+ "<m01Te>-0.1</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.7</m03Te>\r\n"
			+ "</item>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 05:00</tm>\r\n"
			+ "<rnum>5</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>0.2</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>1.8</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>290</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>54</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>3.3</pv>\r\n"
			+ "<td>-8.0</td>\r\n"
			+ "<pa>1008.0</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1018.8</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss/>\r\n"
			+ "<ssQcflg>9</ssQcflg>\r\n"
			+ "<icsr/>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>1</dc10Tca>\r\n"
			+ "<dc10LmcsCa>1</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd>Sc</clfmAbbrCd>\r\n"
			+ "<lcsCh>10</lcsCh>\r\n"
			+ "<vs>714</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo>40</dmstMtphNo>\r\n"
			+ "<ts>-2.9</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>-0.1</m005Te>\r\n"
			+ "<m01Te>-0.1</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.7</m03Te>\r\n"
			+ "</item>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 06:00</tm>\r\n"
			+ "<rnum>6</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>-0.8</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>3.5</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>290</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>47</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>2.7</pv>\r\n"
			+ "<td>-10.7</td>\r\n"
			+ "<pa>1008.9</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1019.8</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss/>\r\n"
			+ "<ssQcflg>9</ssQcflg>\r\n"
			+ "<icsr/>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>0</dc10Tca>\r\n"
			+ "<dc10LmcsCa>0</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd/>\r\n"
			+ "<lcsCh/>\r\n"
			+ "<vs>1152</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo>40</dmstMtphNo>\r\n"
			+ "<ts>-3.2</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>-0.2</m005Te>\r\n"
			+ "<m01Te>0.0</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.7</m03Te>\r\n"
			+ "</item>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 07:00</tm>\r\n"
			+ "<rnum>7</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>-1.6</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>2.6</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>290</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>52</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>2.8</pv>\r\n"
			+ "<td>-10.1</td>\r\n"
			+ "<pa>1009.4</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1020.3</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss/>\r\n"
			+ "<ssQcflg>9</ssQcflg>\r\n"
			+ "<icsr/>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>0</dc10Tca>\r\n"
			+ "<dc10LmcsCa>0</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd/>\r\n"
			+ "<lcsCh/>\r\n"
			+ "<vs>1041</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo/>\r\n"
			+ "<ts>-4.0</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>-0.2</m005Te>\r\n"
			+ "<m01Te>-0.1</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.7</m03Te>\r\n"
			+ "</item>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 08:00</tm>\r\n"
			+ "<rnum>8</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>-2.4</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>3.6</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>270</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>50</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>2.6</pv>\r\n"
			+ "<td>-11.4</td>\r\n"
			+ "<pa>1010.6</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1021.5</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss>0.0</ss>\r\n"
			+ "<ssQcflg/>\r\n"
			+ "<icsr>0.0</icsr>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>0</dc10Tca>\r\n"
			+ "<dc10LmcsCa>0</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd/>\r\n"
			+ "<lcsCh/>\r\n"
			+ "<vs>1082</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo/>\r\n"
			+ "<ts>-4.1</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>-0.3</m005Te>\r\n"
			+ "<m01Te>0.0</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.7</m03Te>\r\n"
			+ "</item>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 09:00</tm>\r\n"
			+ "<rnum>9</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>-2.4</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>5.3</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>320</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>38</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>1.9</pv>\r\n"
			+ "<td>-14.8</td>\r\n"
			+ "<pa>1011.5</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1022.4</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss>0.4</ss>\r\n"
			+ "<ssQcflg/>\r\n"
			+ "<icsr>0.27</icsr>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>0</dc10Tca>\r\n"
			+ "<dc10LmcsCa>0</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd/>\r\n"
			+ "<lcsCh/>\r\n"
			+ "<vs>1474</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo/>\r\n"
			+ "<ts>-2.8</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>-0.3</m005Te>\r\n"
			+ "<m01Te>0.0</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.8</m03Te>\r\n"
			+ "</item>\r\n"
			+ "<item>\r\n"
			+ "<tm>2019-01-20 10:00</tm>\r\n"
			+ "<rnum>10</rnum>\r\n"
			+ "<stnId>108</stnId>\r\n"
			+ "<stnNm>서울</stnNm>\r\n"
			+ "<ta>-1.6</ta>\r\n"
			+ "<taQcflg/>\r\n"
			+ "<rn/>\r\n"
			+ "<rnQcflg/>\r\n"
			+ "<ws>4.1</ws>\r\n"
			+ "<wsQcflg/>\r\n"
			+ "<wd>290</wd>\r\n"
			+ "<wdQcflg/>\r\n"
			+ "<hm>34</hm>\r\n"
			+ "<hmQcflg/>\r\n"
			+ "<pv>1.8</pv>\r\n"
			+ "<td>-15.4</td>\r\n"
			+ "<pa>1012.1</pa>\r\n"
			+ "<paQcflg/>\r\n"
			+ "<ps>1023.0</ps>\r\n"
			+ "<psQcflg/>\r\n"
			+ "<ss>1.0</ss>\r\n"
			+ "<ssQcflg/>\r\n"
			+ "<icsr>0.93</icsr>\r\n"
			+ "<dsnw/>\r\n"
			+ "<hr3Fhsc/>\r\n"
			+ "<dc10Tca>0</dc10Tca>\r\n"
			+ "<dc10LmcsCa>0</dc10LmcsCa>\r\n"
			+ "<clfmAbbrCd/>\r\n"
			+ "<lcsCh/>\r\n"
			+ "<vs>1707</vs>\r\n"
			+ "<gndSttCd/>\r\n"
			+ "<dmstMtphNo/>\r\n"
			+ "<ts>1.5</ts>\r\n"
			+ "<tsQcflg/>\r\n"
			+ "<m005Te>-0.1</m005Te>\r\n"
			+ "<m01Te>-0.1</m01Te>\r\n"
			+ "<m02Te>0.2</m02Te>\r\n"
			+ "<m03Te>0.7</m03Te>\r\n"
			+ "</item>\r\n"
			+ "</items>\r\n"
			+ "<numOfRows>10</numOfRows>\r\n"
			+ "<pageNo>1</pageNo>\r\n"
			+ "<totalCount>9961</totalCount>\r\n"
			+ "</body>\r\n"
			+ "</response>";

	@Test
	void test() {
		
        try {
        	JAXBContext jc = JAXBContext.newInstance(ASOSResponse.class);
        	Unmarshaller unmarshaller = jc.createUnmarshaller();
			ASOSResponse asosResponse = (ASOSResponse) unmarshaller.unmarshal(new ByteArrayInputStream(xml.getBytes()));
			assertNotNull(asosResponse);
			assertNotNull(asosResponse.getBody());
			assertNotNull(asosResponse.getHeader());
			assertNotNull(asosResponse.getBody().getItems());
			assertNotNull(asosResponse.getBody().getItems().getItem());
			assertEquals(10, asosResponse.getBody().getItems().getItem().size());
			assertEquals(108, asosResponse.getBody().getItems().getItem().get(0).getStnId());
        } catch (JAXBException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

}
